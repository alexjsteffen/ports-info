# Original Python implementation preserved for reference
# ...existing code...
